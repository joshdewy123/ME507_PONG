\doxysection{Core/\+Inc/motor.h File Reference}
\hypertarget{motor_8h}{}\label{motor_8h}\index{Core/Inc/motor.h@{Core/Inc/motor.h}}


Motor control driver for bidirectional PWM-\/based DC motors.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include "{}stm32f4xx\+\_\+hal.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structmotor__t}{motor\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Motor object structure for bidirectional PWM control. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{motor_8h_adcde1cd0aa97d50c0b1136c125b5ae10}{set\+\_\+duty}} (\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}p\+\_\+mot, int32\+\_\+t duty)
\begin{DoxyCompactList}\small\item\em Set motor duty cycle and direction. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{motor_8h_a2c3f02a54893461ce371dfe296b020f7}{move\+\_\+to}} (\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}p\+\_\+mot, int32\+\_\+t target, int32\+\_\+t actual)
\begin{DoxyCompactList}\small\item\em Move motor toward target position using proportional control. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{motor_8h_a5f5eeae83ea21ae12701b0c0b78e691f}{disable}} (\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}p\+\_\+mot)
\begin{DoxyCompactList}\small\item\em Disable motor output (coast both sides) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{motor_8h_a87e0de30f5044f896afc5ddaeff0f632}{enable}} (\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}p\+\_\+mot)
\begin{DoxyCompactList}\small\item\em Enable motor output with full PWM to both channels. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Motor control driver for bidirectional PWM-\/based DC motors. 

This module defines the \doxylink{structmotor__t}{motor\+\_\+t} struct and function prototypes for controlling brushed DC motors (e.\+g., turret and flywheel motors) via dual PWM channels.

Used for\+:
\begin{DoxyItemize}
\item Turret aiming motors (Pololu 50\+:1 DC motors with encoders)
\item Flywheel launcher motors (Maxon DC motors) 
\end{DoxyItemize}

\label{doc-func-members}
\Hypertarget{motor_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{motor_8h_a5f5eeae83ea21ae12701b0c0b78e691f}\index{motor.h@{motor.h}!disable@{disable}}
\index{disable@{disable}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{disable()}{disable()}}
{\footnotesize\ttfamily \label{motor_8h_a5f5eeae83ea21ae12701b0c0b78e691f} 
void disable (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{p\+\_\+mot}{}\end{DoxyParamCaption})}



Disable motor output (coast both sides) 


\begin{DoxyParams}{Parameters}
{\em p\+\_\+mot} & Pointer to motor object\\
\hline
\end{DoxyParams}
Disable motor output (coast both sides) \Hypertarget{motor_8h_a87e0de30f5044f896afc5ddaeff0f632}\index{motor.h@{motor.h}!enable@{enable}}
\index{enable@{enable}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{enable()}{enable()}}
{\footnotesize\ttfamily \label{motor_8h_a87e0de30f5044f896afc5ddaeff0f632} 
void enable (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{p\+\_\+mot}{}\end{DoxyParamCaption})}



Enable motor output with full PWM to both channels. 


\begin{DoxyParams}{Parameters}
{\em p\+\_\+mot} & Pointer to motor object\\
\hline
\end{DoxyParams}
Enable motor output with full PWM to both channels. \Hypertarget{motor_8h_a2c3f02a54893461ce371dfe296b020f7}\index{motor.h@{motor.h}!move\_to@{move\_to}}
\index{move\_to@{move\_to}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{move\_to()}{move\_to()}}
{\footnotesize\ttfamily \label{motor_8h_a2c3f02a54893461ce371dfe296b020f7} 
void move\+\_\+to (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{p\+\_\+mot}{, }\item[{int32\+\_\+t}]{target}{, }\item[{int32\+\_\+t}]{actual}{}\end{DoxyParamCaption})}



Move motor toward target position using proportional control. 


\begin{DoxyParams}{Parameters}
{\em p\+\_\+mot} & Pointer to motor object \\
\hline
{\em target} & Desired position in user units (e.\+g., degrees Ã— 10) \\
\hline
{\em actual} & Current position in user units\\
\hline
\end{DoxyParams}
Move motor toward target position using proportional control.

Uses a simple P-\/controller with anti-\/windup and deadband handling. \Hypertarget{motor_8h_adcde1cd0aa97d50c0b1136c125b5ae10}\index{motor.h@{motor.h}!set\_duty@{set\_duty}}
\index{set\_duty@{set\_duty}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{set\_duty()}{set\_duty()}}
{\footnotesize\ttfamily \label{motor_8h_adcde1cd0aa97d50c0b1136c125b5ae10} 
void set\+\_\+duty (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmotor__t}{motor\+\_\+t}} \texorpdfstring{$\ast$}{*}}]{motor}{, }\item[{int32\+\_\+t}]{duty}{}\end{DoxyParamCaption})}



Set motor duty cycle and direction. 


\begin{DoxyParams}{Parameters}
{\em p\+\_\+mot} & Pointer to motor object \\
\hline
{\em duty} & Signed duty cycle (-\/100 to +100)\\
\hline
\end{DoxyParams}
Set motor duty cycle and direction.

Adjusts direction and magnitude using complementary PWM logic. For turret1, logic is inverted to account for wiring or mechanical setup. 